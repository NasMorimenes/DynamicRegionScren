#Include Includes.ahk
R := 255
G := 25
B := 100

; := Buffer(12, 0)

;Hex := "660FEFC9660FEFDB660FEFD2F20F102500000000660FEFC089D289C94489C0F2480F2ACA4489C2F2480F2ADAF2480F2AD1F20F59CCF20F59DCF20F59D4F20F102510000000F20F5AC9F30F5AC1F20F100D08000000F20F5ADBF30F5ADBF20F59E3F20F59C8F20F5AD2F30F5AD2F20F58CCF20F102518000000F20F59E2F20F58CCF20F102528000000F20F59E3F20F5AC9F3410F1109F20F100D20000000F20F591D40000000F20F59C8F20F590538000000F20F58CCF20F102530000000F20F59E2F20F591548000000F20F58CCF20F5AC9F3410F114904660F28C8660F28C3F20F58C1F20F58C2F20F5AC0F3410F114108C390909090909090909090909090101010101010703FA52C431CEBE2D63FB4C876BE9F1AC73FA2B437F8C264DA3FA52C431CEBE2E63F5D6DC5FEB27BB23FBC96900F7A36CB3F32E6AE25E483BE3FD122DBF97E6AEE3FA54E401361C3933F"
;len := StrLen(hex) // 2
;code := "C:\Users\morim\OneDrive\DynamicRegionScren\PicFind\NewTest 29.08.2024\Complex Color Difference\rgb_to_xyz.dll\rgb_to_xyz"
;Hex := "4883EC580F297424300F297C2440660FEFC9F20F100500000000660F281510000000660F283D70000000660F281D40000000660F28355000000089C8C1E8100FB6C0F20F2AC80FB6C50FB6C9F20F59C8F20F110C24660FEFC9F20F2AC889D0C1E8100FB6C0F20F59C8F20F114C2408660FEFC9F20F2AC9F20F59C8F20F114C2410660FEFC9F20F2AC80FB6C60FB6D2F20F59C8F20F114C2418660FEFC9660F28642410F20F2AC8F20F59C8F20F114C2420660FEFC9F20F2ACAF20F59C1F20F11442428660F280424660F28C8660F28E8660F14E00F166C2418660FC6C801660F164C24200F16642428660F280520000000660F59D1660F59C5660F59FD660F592DC0000000660F58D0660F280530000000660F59C4660F58D0660F280560000000660F59C1660F590DB0000000660F59DA660F58C7660F283D80000000660F58CD660F59FC660F58DE660F5925D0000000660F58C7660F5905900000000F287C2440660F58CC660F590DE0000000660F5CC2660F5905A0000000660F5CD1660F5915F0000000660F28CB660F15DBF20F5CCB660F58C60F28742430F20F59C9660F28D8660F15C0F20F5CD8660F28C2660F15D2F20F5CC2F20F59DBF20F59C0F20F58CBF20F58C1F20F51C04883C458C3101010101010703F0000000000000000A52C431CEBE2E63FA52C431CEBE2E63FBC96900F7A36CB3FBC96900F7A36CB3F5D6DC5FEB27BB23F5D6DC5FEB27BB23F0000000000005D400000000000005D4000000000000030C000000000000030C0A52C431CEBE2D63FA52C431CEBE2D63FA2B437F8C264DA3FA2B437F8C264DA3FB4C876BE9F1AC73FB4C876BE9F1AC73F3054616872D5F03F3054616872D5F03F0000000000407F400000000000407F4032E6AE25E483BE3F32E6AE25E483BE3FA54E401361C3933FA54E401361C3933FD122DBF97E6AEE3FD122DBF97E6AEE3FF5143515AC63ED3FF5143515AC63ED3F00000000000069400000000000006940"
;len := StrLen(hex) // 2
;code := Buffer( len, 0 )
;code := MCode( Hex )
/*
DllCall(
    "crypt32\CryptStringToBinary",
    "Str", hex,
    "uint", 0,
    "uint", 4,
    "Ptr", code,
    "uint*", &len,
    "Ptr", 0,
    "Ptr", 0
)

DllCall(
    "VirtualProtect",
    "Ptr", code,
    "Ptr", len,
    "uint", 0x40,0
    "Ptr*", 0
)

Result :=
DllCall(
    code,
    "UInt", 0x5BB626,
    "UInt", 0x000000,
    "float"

)
*/
result :=
    DllCall(
        "rgbHuman2.dll\lab_color_difference",
        "uint", 0x7DDA58,
        "uint", 0x7DFF5F ,
        "double"
    )

MsgBox( Result )

/*
result :=
    DllCall(
        "rgb_to_xyz.dll\rgb_to_xyz",
        "uint", R,
        "uint", G,
        "uint", B,
        "Ptr", X.Ptr
    )

MsgBox "X: " NumGet(x, 0, "float") ", Y: " NumGet(x, 4, "float") ", Z: " NumGet(x, 8, "float")